---
title:  "pygame을 이용한 게임 만들기 - 02. 배경 그리기"
excerpt: "게임을 시작하려면 먼저 게임을 플레이 할 창이 필요하다. 이번 포스팅에서는 내가 만든 게임이 플레이 될 프레임을 하나 띄우고 그 안에 캐릭터가 될 이미지를 띄우는 실습을 해보자."
toc: true
toc_sticky: true
categories:
  - Python
tags:
  - Tech
  - Pygame
  - '2020'
last_modified_at: 2020-08-25
---

게임을 시작하려면 먼저 게임을 플레이 할 창이 필요하다.
이번 포스팅에서는 내가 만든 게임이 플레이 될 프레임을 하나 띄우고 그 안에 캐릭터가 될 이미지를 띄우는 실습을 해보자.

실습의 전반적인 튜토리얼은 [나도코딩](https://www.youtube.com/channel/UC7iAOLiALt2rtMVAWWl4pnw){: target="_blank"} Youtube 채널을 참고하였다.

## import pygame

저번 포스팅에서 `pygame` 라이브러리를 설치하고 실제 동작하는지 테스트 코드까지 짜 보았다. 이번에는 정상적으로 import가 되는지 테스트 해보자.

프로젝트 Root 폴더아래 `pygame_basic`이라는 폴더를 하나 만들어 주고 `1_create_frame.py` 파일을 하나 생성해 준다.

```python
import pygame
```

위와 같이 `pygame` 라이브러리를 import 해주고 그냥 실행시켰을 때 아래와 같이 뜬다면 성공이다.

![pygame_import](/assets/images/2020/08/pygame-import.png)

버전 정보는 조금 상이할 수도 있으나 위의 메시지가 나오면 성공적으로 import 된 것이다. import 가 되지 않았다면 해당 라이브러리를 찾지 못했다고 오류가 뜰 텐데 실제로 라이브러리가 설치되었음에도 경로를 찾지 못한다면 가상 환경을 사용하고 있는 터미널(혹은 인터프리터)이 잡지 못하고 있는 것이다. python 가상환경이 제대로 진입된 것인지 확인하자.

## Frame 띄워보기

그 다음으로는 게임을 실행시킬 창을 생성해보자.
백문이 불여일견이라 아래 코드를 보자.

```python
# Init pygame
pygame.init()

# Set Window Size
screen_width = 480      # 가로
screen_height = 640     # 세로
screen = pygame.display.set_mode((screen_width, screen_height))

# Set Title
pygame.display.set_caption("monetd's snake game")

# Event loop
running = True          # 게임이 진행 중인가?
while running:
    for event in pygame.event.get():     # 어떤 이벤트가 발생하였는가?
        if event.type == pygame.QUIT:   # 창이 닫히는 이벤트가 발생하였는가?
            running = False             # 게임이 진행중이 아님

# pygame 종료
pygame.quit()
```

코드를 순서대로 설명하면 다음과 같다.

```python
# Init pygame
pygame.init()
```

이 부분은 무조건 pygame 모듈 사용시 초기화를 해주는 부분으로 pygame을 이용하려면 반드시 들어가야 하는 부분이다.

```python
# Set Window Size
screen_width = 480      # 가로
screen_height = 640     # 세로
screen = pygame.display.set_mode((screen_width, screen_height))
```

창의 가로와 세로 사이즈(px 단위)를 설정해준다. 그리고 설정한 사이즈대로 창을 열어준다.

```python
# Event loop
running = True          # 게임이 진행 중인가?
while running:
    for event in pygame.event.get():     # 어떤 이벤트가 발생하였는가?
        if event.type == pygame.QUIT:   # 창이 닫히는 이벤트가 발생하였는가?
            running = False             # 게임이 진행중이 아님
```

아마 이 부분없이 파일을 실행하면 창이 바로 닫힐 것이다.
`running`이라는 변수는 게임이 계속 진행중인지 체크하는 boolean 변수이다.
이 변수가 `True`일 동안 게임은 계속 실행이 될 것이다.

안의 `for`문은 게임이 진행 중인 상태에서 어떤 이벤트가 발생하면 `event`라는 변수에 해당 이벤트를 가져온다. 만약 이 이벤트의 타입이 `pygame.QUIT`일 경우 `running`변수는 `False`가 되고 루프를 탈출하게 될 것이다.

```python
# pygame 종료
pygame.quit()
```

마지막으로 `pygame.quit()` 을 호출하여 모듈을 종료해 준다.

위의 코드를 실행시킨 결과는 다음과 같다.

![empty_frame](/assets/images/2020/08/empty-frame.png)

우리가 설정한 사이즈대로 창이 뜬것을 볼 수 있다.
오른쪽 상단(MAC이라면 왼쪽 상단)의 **[X]**자를 눌러서 창을 닫으면 프로그램이 종료된다.

## 배경 넣기

여차저차 프레임을 띄웠지만 배경이 너무 없으니 조금 심심하다.
이번에는 해당 프레임에 맞는 배경을 그려보자.
이번에는 `2_background.py`라는 파일을 만들었다.


### 배경 이미지 준비

그리고 배경에 활용할 이미지를 만들어야 한다.
윈도우면 그림판을 사용하거나 혹은 자신이 원하는 편집툴을 사용하여
`480 x 640` 새 파일을 만들고 배경색을 원하는 색으로 넣어준다.
그리고 프로젝트 폴더밑에 `background.png`로 저장한다.

단순한게 싫다면 구글링을 통해 해당 사이즈의 이미지를 받아도 좋다.

나의 경우 MAC환경에서 실습을 진행하였기에 `paintbrush`라는 앱을 사용하여 간단한 배경 이미지를 만들었다.

![pygame_bacic_folder](/assets/images/2020/08/pygame-bacic-folder.png)
### 코드 작성

사전 준비가 다 되었다면
이것 어려운 코드가 아니기에 바로 전체코드를 넣겠다.

```python
import pygame

# Init pygame
pygame.init()

# Set Window Size
screen_width = 480      # 가로
screen_height = 640     # 세로
screen = pygame.display.set_mode((screen_width, screen_height))

# Set Title
pygame.display.set_caption("monetd's snake game")

# Set background
background = pygame.image.load('/Users/iyongjae/workspaces/pygame/pygame_basic/background.png')

# Event loop
running = True          # 게임이 진행 중인가?
while running:
    for event in pygame.event.get():    # 어떤 이벤트가 발생하였는가?
        if event.type == pygame.QUIT:   # 창이 닫히는 이벤트가 발생하였는가?
            running = False             # 게임이 진행중이 아님

    screen.blit(background, (0, 0))     # 배경 그리기
    # screen.fill((0, 0, 255))            # 색으로 배경 그리기
    pygame.display.update()             # 게임 화면 다시 그리기

# pygame 종료
pygame.quit()
```

대부분의 코드가 1번의 프레임을 띄우는 코드와 중복된다.
추가된 코드블럭은 아래와 같다.

```python
# Set background
background = pygame.image.load('/Users/iyongjae/workspaces/pygame/pygame_basic/background.png')
```

위의 사전과정에서 준비된 이미지를 불러와 background라는 변수에 넣어주고 있다.
이렇게 저장한 변수를 이제 불러오면 된다.

```python
while running:
    for event in pygame.event.get():    # 어떤 이벤트가 발생하였는가?
        if event.type == pygame.QUIT:   # 창이 닫히는 이벤트가 발생하였는가?
            running = False             # 게임이 진행중이 아님

    screen.blit(background, (0, 0))     # 배경 그리기
    # screen.fill((0, 0, 255))          # 색으로 배경 그리기
    pygame.display.update()             # 게임 화면 다시 그리기
```

`screen.blit()` 메서드를 통해 배경을 그리고 있다.
해당 메서드의 첫번째 인자는 배경으로 넣을 이미지를 담은 변수고, 두번째는 넣어질 이미지의 좌표를 튜플로 받고 있다. 우리는 배경 프레임과 같은 사이즈로 했으므로 (0, 0)을 넣어주면 된다.

참고로 해당 좌표값은 **배경이미지의 좌측 상단 기준**이라고 보면 된다.
예를들어 해당 좌표값에 (480, 640)을 넣게 된다면 배경은 **해당 프레임의 우측 하단** 서부터 시작되기 때문에 전혀 바뀌는게 없을 것이다. 지금은 단순하여 어렵지 않지만, 배경에서는 후에 캐릭터나 오브젝트 이미지를 넣을 때는 이 부분을 조심하여야 한다.

`screen.blit()` 메서드 밑에 주석처리된 `screen.fill()` 메서드는 RGB 값으로 배경을 채우는 메서드이다. 역시 각각 Red, Green, Blue를 나타내는 3차원 튜플이 값으로 들어가게 된다. 코드에서는 주석처리가 되어있지만 한번 실습해 보자.

마지막으로 `pygame.display.update()`를 통해 화면을 업데이트 해주면 우리가 설정한 배경이 창에 나오게 된다. 만약 이 메서드를 호출하지 않으면 어떻게 될까? 실제로 설정은 되었지만 프레임을 갱신해주지 않았기 때문에 화면은 이전화면처럼 계속 나오게 될 것이다. 마치 영화에서 다음 장면이 있지만 영사기가 돌아가지 않아 이전 프레임만 계속 나오는 효과인 것이다.

## 결과

코드를 실행해본 최종 화면은 아래와 같다.

![final_frame](/assets/images/2020/08/final-frame.png)

배경이 검은 화면이 아니고 단색으로 표현되었지만 아직도 뭔가 어색하다.
다음에는 이 배경위에 오브젝트를 올려보겠다.

## Reference
- [파이썬 코딩 무료 강의(활용편1) - 추억의 오락실 게임을 만들어 보아요. 3시간이면 충분합니다. [나도코딩]](https://youtu.be/Dkx8Pl6QKW0){: target="_blank"}
